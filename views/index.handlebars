<div class="jumbotron jumbotron-fluid">
  <div class="container">
    <h1 class="display-4 text-center">MongoDB Scraper</h1>
    <p class="lead text-center">News Edition</p>
  </div>
</div>

<div>
  <div id="article"></div>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

<script>
  $(document).ready(function(){
    $("#scrape").on("click", async function(e){
      $('#article').empty()
      e.preventDefault();
      const articles = await axios.post('/api/scrape', null);
      for (var i = 0; i < 10; i++) {
        let b = i + 10;
        const headline = articles.data.scrape[i].headline
        const link = articles.data.scrape[i].link
        const summary = articles.data.scrape[b].summary;
        var article = 
        `<div class="card">
          <div class="card-header">
            <h1><strong><a href="${link}" target="_blank">
              ${headline}
            </a></strong></h1>
          </div>
          <div class="card-body">
            <a class="card-text" href="${link}" target="_blank">${summary}</a>
            <button class="btn btn-primary saveBtn" headline="${headline}" link="${link}" summary="${summary}">
              SAVE ARTICLE!
            </button>
          </div>
        </div>`
        $('#article').append(article);
      }
      $(".saveBtn").on("click", async function(e){
        e.preventDefault();
        const header = $(this).attr('headline');
        const anchor = $(this).attr('link');
        const copy = $(this).attr('summary')
        const savedArticle = {
          headline: header,
          link: anchor,
          summary: copy
        }
        try {
          const newArticle = await axios.post('/api/articles', savedArticle);
          console.log(newArticle);
        }
        catch (err) {
          console.log(`Error: ${err.message}`)
        }
      });
    });

  });
</script>